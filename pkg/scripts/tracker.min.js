let e="{{ .serverAddress }}",n=localStorage.getItem("sessionID"),o=(n||(n=crypto.randomUUID(),localStorage.setItem("sessionID",n)),""),a=fetch(e+"/ip").then(t=>t.text().then(t=>o=t)),i=window.location.hostname,s=navigator.userAgent;var t,r;d=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(s),t=/mobi/i.test(s.toLowerCase()),r="ontouchstart"in window||navigator.msMaxTouchPoints||0<navigator.maxTouchPoints;let c=(d||t)&&r?"mobile":"desktop";var d=async()=>{await a;var t=window.location.pathname+window.location.search,t={domain:i,path:t,ip:o,userAgent:s,session:n,device:c};200!==(await fetch(e+"/api/collections/views/records",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).status&&console.error("Failed to track view"),console.log("Tracked view",t)};d();{let e=history.pushState,n=(history.pushState=function(){var t=e.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),t},history.replaceState);history.replaceState=function(){var t=n.apply(this,arguments);return window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange")),t},window.addEventListener("popstate",()=>{window.dispatchEvent(new Event("locationchange"))})}window.addEventListener("locationchange",d);