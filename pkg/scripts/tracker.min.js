let t="{{ .serverAddress }}",n=localStorage.getItem("sessionID"),o=(n||(n=crypto.randomUUID(),localStorage.setItem("sessionID",n)),""),a=fetch(t+"/ip").then(e=>e.text().then(e=>o=e)),i=window.location.hostname,s=navigator.userAgent;var e,r;d=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(s),e=/mobi/i.test(s.toLowerCase()),r="ontouchstart"in window||navigator.msMaxTouchPoints;let c=(d||e)&&r?"mobile":"desktop";var d=async()=>{await a;var e=window.location.pathname+window.location.search,e={domain:i,path:e,ip:o,userAgent:s,session:n,device:c};200!==(await fetch(t+"/api/collections/views/records",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).status&&console.error("Failed to track view"),console.log("Tracked view",e)};d();{let t=history.pushState,n=(history.pushState=function(){var e=t.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),e},history.replaceState);history.replaceState=function(){var e=n.apply(this,arguments);return window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange")),e},window.addEventListener("popstate",()=>{window.dispatchEvent(new Event("locationchange"))})}window.addEventListener("locationchange",d);